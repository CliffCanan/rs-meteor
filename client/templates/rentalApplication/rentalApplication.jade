template(name="rentalApplication")
  with this
    if canAccess
      #rental-application-wrapper.container   
        .row
          .col-lg-8
            h1 Rental Application
          .col-lg-4
            .application-dates
              .pull-right
                i.fa.fa-clock-o
                | Created on {{getReadableLongDate createdAt}}
                br
                i.fa.fa-undo
                a#application-revisions(href="#rental-application-show-revisions", data-toggle="modal") #{rentalApplicationRevisionsCount} Revisions
          .col-lg-12
            p After completing the form below, please click "Download PDF" to save a copy on your computer. Please email the completed PDF to info@therentscene.com with a copy of your Drivers License, Pay Stub, and Bank Statement. Thank you!

            form#rental-application-form.form-inline
              h3 Rent Details
              .form-group
                label Which unit are you applying to
                input.input-large.form-control(type="text", name="unitName", value="#{fields.unitName}")
              br
              .form-group
                label Move in date
                +datepicker(name="moveInDate" value=getDatePickerDateMoveInDate)
              .form-group
                label Lenght of lease
                input.input-small.form-control(type="text", name="lenghtOfLease", value="#{fields.lenghtOfLease}")
              .form-group
                label Rent
                .input-group
                  .input-group-addon $
                  input.input-tiny.form-control(type="text", name="rent", value="#{fields.rent}")
              h3 Personal Information
              .form-group
                label Applicant's full name
                input.input-large.form-control(type="text", name="fullName", value="#{fields.fullName}")
              .form-group
                label Date of birth
                +datepicker(name="dateOfBirth" options=dateOfBirthOptions value=getDatePickerDateDateOfBirth)
              .form-group
                label Social security number
                input.input-medium.form-control(type="text", name="socialSecurityNumber", value="#{fields.socialSecurityNumber}")
              .form-group
                label Email
                input.input-large.form-control(type="email", name="email", value="#{fields.email}")
              .form-group
                label Phone number
                input.input-medium.form-control(type="text", name="phoneNumber", value="#{fields.phoneNumber}")
              br
              .form-group
                label Living with partner / family
                select.form-control(name="livingWithAnother", value="#{fields.livingWithAnother}")
                  option(value="Yes") Yes
                  option(value="No", selected) No
              br
              .form-group
                label Do you have any pets?
                select.form-control(name="livingWithAnother", value="#{fields.livingWithAnother}")
                  option(value="Yes") Yes
                  option(value="No", selected) No
              h3 Required documents
              p Drop required documents for the application below
              form(action="/file-upload").dropzone.dropzone-user
                .dz-message Drop files here to upload (or click)
                table#files-list.table
                  thead
                    tr
                      th File name
                      th Type
                      th Size
                      th Uploaded on
                      th Actions
                  tbody
                    each documents
                      tr
                        td #{name}
                        td
                          select.form-control.document-type
                            option -- Select a document type --
                            option(value="Bank Statement", selected="{{isSelected 'Bank Statement'}}") Bank Statement
                            option(value="Drivers License", selected="{{isSelected 'Drivers License'}}") Drivers License
                            option(value="Immigration Document", selected="{{isSelected 'Immigration Document'}}") Immigration Document
                            option(value="Pay Stub", selected="{{isSelected 'Pay Stub'}}") Pay Stub
                            option(value="Other", selected="{{isSelected 'Other'}}") Other
                        td #{size}
                        td {{getReadableLongDate uploadedAt}}
                        td
                          a(href="{{url}}", target="_blank")
                            i.fa.fa-eye
                          a(href="#")
                            i.fa.fa-trash

                if showDocumentsFromAdmin
                  h3 Documents from Admin
                  if canOperateWithBuilding
                    p Drop documents from Admin below
                    form(action="/file-upload").dropzone.dropzone-admin
                      .dz-message Drop files here to upload (or click)
                      table.table
                        thead
                          tr
                            th File name
                            th Type
                            th Size
                            th Uploaded on
                            th Shared with user
                            th Actions
                        tbody
                          each documentsFromAdmin
                            tr
                              td #{name}
                              td
                                select.form-control.document-type
                                  option -- Select a document type --
                                  option(value="Bank Statement", selected="{{isSelected 'Bank Statement'}}") Bank Statement
                                  option(value="Drivers License", selected="{{isSelected 'Drivers License'}}") Drivers License
                                  option(value="Immigration Document", selected="{{isSelected 'Immigration Document'}}") Immigration Document
                                  option(value="Pay Stub", selected="{{isSelected 'Pay Stub'}}") Pay Stub
                                  option(value="Other", selected="{{isSelected 'Other'}}") Other
                              td #{size}
                              td {{getReadableLongDate uploadedAt}}
                              td
                                input.shared-with-user(type="checkbox", checked=isSharedWithUser)
                              td
                                a(href="{{url}}", target="_blank")
                                  i.fa.fa-eye
                                a(href="#")
                                  i.fa.fa-trash
                  else
                    table.table
                      thead
                        tr
                          th File name
                          th Type
                          th Size
                          th Uploaded on
                          th Actions
                      tbody
                        each documentsFromAdmin
                          tr
                            td #{name}
                            td
                              select.form-control
                                option -- Select a document type --
                                option(value="Bank Statement", selected="{{isSelected 'Bank Statement'}}") Bank Statement
                                option(value="Drivers License", selected="{{isSelected 'Drivers License'}}") Drivers License
                                option(value="Immigration Document", selected="{{isSelected 'Immigration Document'}}") Immigration Document
                                option(value="Pay Stub", selected="{{isSelected 'Pay Stub'}}") Pay Stub
                                option(value="Other", selected="{{isSelected 'Other'}}") Other
                            td #{size}
                            td {{getReadableLongDate uploadedAt}}
                            td
                              a(href="{{url}}", target="_blank")
                                i.fa.fa-eye

              h3 Signature
              p I hereby authorize The Rent Scene LLC to obtain and/or verify my credit report, criminal history, employment references and personal references in connection with the processing of this rental application. I also agree to the deposit disclaimer.

              #signature

              .form-group
                .col-sm-12
                  button.btn.btn-success(type="submit") Submit and download PDF
                  a.btn.btn-info(href="{{pathFor 'rentalApplication' id=_id}}/download", target="_blank") Download PDF

          #rental-application-password.modal.fade
            .modal-dialog
              form#rental-application-password-form.modal-content
                .modal-header
                  button.close(type="button", data-dismiss="modal", aria-label="Close")
                    i.fa.fa-times(aria-hidden="true")
                  h4.modal-title Enter a password to submit form
                .modal-body
                  p Please enter a password for your appplication to keep it protected. You will be prompted to enter it again the next time you visit the form.
                  .form-group
                    input#password.form-control(type="password", name="password", placeholder="Your password")
                .modal-footer
                  button.btn.btn-success(type="submit") Confirm password

          #rental-application-save-revision.modal.fade
            .modal-dialog
              form#rental-application-save-revision-form.modal-content
                .modal-header
                  button.close(type="button", data-dismiss="modal", aria-label="Close")
                    i.fa.fa-times(aria-hidden="true")
                  h4.modal-title Please enter a note to describe your changes
                .modal-body
                  p Please describe what was changed in your application so we can process it accordingly.
                  .form-group
                    textarea#updateNote.form-control(name="update-note", placeholder="Note for update", rows="3")
                .modal-footer
                  button.btn.btn-success(type="submit") Confirm changes

          #rental-application-show-revisions.modal.fade
            .modal-dialog
              form#rental-application-save-revision-form.modal-content
                .modal-header
                  button.close(type="button", data-dismiss="modal", aria-label="Close")
                    i.fa.fa-times(aria-hidden="true")
                  h4.modal-title Revisions for application
                .modal-body
                  p Below are the list of revisions for this form
                  table.table
                    thead
                      tr
                        th Revision date
                        th Note
                        th Actions
                    tbody
                      each rentalApplicationRevisions
                        tr
                          td {{getReadableShortDateTime revisionSavedAt}}
                          td {{updateNote}}
                          td
                            if isFirstItem this
                              | Current revision
                            else
                              a.revert-rental-application(href="#") Revert to this version
                .modal-footer
                  a.btn.btn-info(href="#", data-dismiss="modal") Close
    else
      #rental-application-access-wrapper.container
        .col-lg-12
          .row
            h1 Password required
            p Please enter the password for this application to continue
            form#rental-application-access-form
              .form-group
                input#password.form-control(type="password", name="Password")
              button.btn.btn-success(type="submit") Continue